import{world as e}from"@minecraft/server";function n(e){return{dimension:e.dimension.id,x:e.x,y:e.y,z:e.z}}function t(n){return{dimension:e.getDimension(n.dimension),x:n.x,y:n.y,z:n.z}}function i(e){return e.dimension.id+Math.floor(e.x).toString()+Math.floor(e.y).toString()+Math.floor(e.z).toString()}function r(n){const t=`fluffyalien_energisticscore:storage${n}`;return e.scoreboard.getObjective(t)??e.scoreboard.addObjective(t)}function o(e,n){if(e.hasParticipant(n))return e.getScore(n)}import{system as c,world as s}from"@minecraft/server";var a=s.getDimension("overworld"),f=new Map,d=new Map;function u(e,n){d.set(e,n)}function l(e,n){a.runCommand(`scriptevent ${e} ${JSON.stringify(n)}`)}function g(e){const n=`${e.description.id}__onTickHandler`;let i;u(n,(n=>e.handlers.onTick(t(n)))),e.handlers.updateUi&&(i=`${e.description.id}__updateUiHandler`,u(i,(n=>e.handlers.updateUi(t(n))))),l("fluffyalien_energisticscore:register_machine",{description:e.description,onTickEvent:n,updateUiEvent:i})}function p(e){l("fluffyalien_energisticscore:update_block_network",n(e))}function m(e){l("fluffyalien_energisticscore:update_block_adjacent_networks",n(e))}function _(e,n){return o(r(n),i(e))??0}function v(e,n,t){r(n).setScore(i(e),t)}function b(n,t){const r=i(n),c=o(function(n){const t=`fluffyalien_energisticscore:itemtype${n.toString()}`;return e.scoreboard.getObjective(t)??e.scoreboard.addObjective(t)}(t),r);if(void 0===c)return;const s=o(function(n){const t=`fluffyalien_energisticscore:itemcount${n.toString()}`;return e.scoreboard.getObjective(t)??e.scoreboard.addObjective(t)}(t),r);return s?{type:c,count:s}:void 0}function y(e,n,t){l("fluffyalien_energistics:set_item_in_machine_slot",{loc:e,slot:n,item:t})}c.afterEvents.scriptEventReceive.subscribe((e=>{const n=f.get(e.id);if(n)return void n(JSON.parse(e.message));const t=d.get(e.id);if(t){const n=JSON.parse(e.message),i=t(n.payload);l(n.responseEvent,i)}}));export{b as getItemInMachineSlot,_ as getMachineStorage,g as registerMachine,y as setItemInMachineSlot,v as setMachineStorage,m as updateBlockAdjacentNetworks,p as updateBlockNetwork};